# Project: snake_game
# Module: 得分和游戏结束逻辑
# Auto-generated by Code Agent

import pygame

def calculate_score(snake_length):
    return snake_length - 3

def check_game_over(snake_list, WIDTH, HEIGHT):
    head = snake_list[-1]
    if head[0] >= WIDTH or head[0] < 0 or head[1] >= HEIGHT or head[1] < 0:
        return True
    for segment in snake_list[:-1]:
        if segment == head:
            return True
    return False

def update_game_state(snake_list, food_x, food_y, WIDTH, HEIGHT, snake_block_size):
    new_head = [snake_list[-1][0], snake_list[-1][1]]
    direction = 'RIGHT'
    if pygame.key.get_pressed()[pygame.K_LEFT]:
        direction = 'LEFT'
    elif pygame.key.get_pressed()[pygame.K_RIGHT]:
        direction = 'RIGHT'
    elif pygame.key.get_pressed()[pygame.K_UP]:
        direction = 'UP'
    elif pygame.key.get_pressed()[pygame.K_DOWN]:
        direction = 'DOWN'

    if direction == 'LEFT':
        new_head[0] -= snake_block_size
    elif direction == 'RIGHT':
        new_head[0] += snake_block_size
    elif direction == 'UP':
        new_head[1] -= snake_block_size
    elif direction == 'DOWN':
        new_head[1] += snake_block_size

    if new_head in snake_list[:-1]:
        return None, False

    if new_head[0] == food_x and new_head[1] == food_y:
        snake_list.append(new_head)
        food_x, food_y = generate_food(snake_list, WIDTH, HEIGHT, snake_block_size)
        return snake_list, True
    else:
        snake_list.pop(0)
        snake_list.append(new_head)
        return snake_list, False

def generate_food(snake_list, WIDTH, HEIGHT, snake_block_size):
    food_x = round(random.randrange(0, WIDTH - snake_block_size) / 10.0) * 10.0
    food_y = round(random.randrange(0, HEIGHT - snake_block_size) / 10.0) * 10.0

    while any([food_x == segment[0] and food_y == segment[1] for segment in snake_list]):
        food_x = round(random.randrange(0, WIDTH - snake_block_size) / 10.0) * 10.0
        food_y = round(random.randrange(0, HEIGHT - snake_block_size) / 10.0) * 10.0

    return food_x, food_y